# ePaper_IoT
base on esp32, drive an epaper device

## bug修复记录

### 硬件驱动不成功

使用同版本软件驱动微雪官方驱动板（2.7寸树莓派墨水屏驱动板），测试通过，自制硬件测试失败。

试错过程：

1. 检查原理图，发现GDR与RESE引脚标注错误，属于设计错误，飞线解决，万用表测试连通。重新测试，测试失败。
2. 检查是不是滤波电容给小了，从100nf改到1uf。重新测试，测试失败。
3. 怀疑是不是0.47r电阻阻值不对导致的，从0r电阻改为两个1r电阻并联（等效0.5r）。重新测试，测试失败。
4. 怀疑是不是3v3电源滤波电容太小了，由100nf改到4.7uf。重新测试，测试失败。
5. 怀疑是不是通信速率过快，同时PCB设计不妥当，导致信号完整性过差。在模拟SPI的单bit写入函数中加入5us延时。重新测试，测试失败。
6. 怀疑是不是没有加滤波电感导致的，但PCB不足以飞线重做，于是重新打板。

这一版本的墨水屏驱动不成功，但IIC和蓝牙/WiFi都没什么问题。



### 问题定位：缺少电感元件

一开始以为电感是滤波用的，与电容组成LC滤波电路

但实际上，这个电感是与MOS管一同组成了boost电路，为墨水屏驱动升压的

![image-20250515100921619](/Users/nino/Documents/esp32/ePaper_IoT/assets/image-20250515100921619.png)

在这个驱动回路中，GDR是栅极驱动引脚，RESE是电流采样引脚

共同组成了boost驱动电路，所以这个电感是不可以缺少的

![image-20250515101205255](/Users/nino/Documents/esp32/ePaper_IoT/assets/image-20250515101205255.png)